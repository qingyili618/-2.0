{"remainingRequest":"D:\\college\\3.1\\PaperSystems\\1205\\专家分配完成 (2)\\专家分配完成 (2)\\vuereview\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\index.js??ref--0-1!D:\\college\\3.1\\PaperSystems\\1205\\专家分配完成 (2)\\专家分配完成 (2)\\vuereview\\src\\views\\DefenceCommittee.vue?vue&type=style&index=0&id=3602e6c7&scoped=true&lang=css","dependencies":[{"path":"D:\\college\\3.1\\PaperSystems\\1205\\专家分配完成 (2)\\专家分配完成 (2)\\vuereview\\src\\views\\DefenceCommittee.vue","mtime":1638690968237},{"path":"D:\\college\\3.1\\PaperSystems\\1205\\专家分配完成 (2)\\专家分配完成 (2)\\vuereview\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\college\\3.1\\PaperSystems\\1205\\专家分配完成 (2)\\专家分配完成 (2)\\vuereview\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\college\\3.1\\PaperSystems\\1205\\专家分配完成 (2)\\专家分配完成 (2)\\vuereview\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\college\\3.1\\PaperSystems\\1205\\专家分配完成 (2)\\专家分配完成 (2)\\vuereview\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\college\\3.1\\PaperSystems\\1205\\专家分配完成 (2)\\专家分配完成 (2)\\vuereview\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQouZWwtcGFnaW5hdGlvbiB7DQogIHRleHQtYWxpZ246IGNlbnRlcjsNCn0NCg=="},{"version":3,"sources":["D:\\college\\3.1\\PaperSystems\\1205\\专家分配完成 (2)\\专家分配完成 (2)\\vuereview\\src\\views\\DefenceCommittee.vue"],"names":[],"mappings":";AAkYA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;EACb,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;AACpB","file":"D:/college/3.1/PaperSystems/1205/专家分配完成 (2)/专家分配完成 (2)/vuereview/src/views/DefenceCommittee.vue","sourceRoot":"","sourcesContent":["<template>\r\n  <div style=\"padding:10px\">\r\n    <div style=\"margin: 10px 0\">\r\n      <!--      <el-input v-model=\"search\" placeholder=\"请输入关键字\" style=\"width: 20%\" clearable></el-input>-->\r\n      <el-select v-model=\"academicYear\" style=\"margin-left: 5px\" placeholder=\"选择学年\">\r\n        <el-option\r\n            v-for=\"item in distinctYear\"\r\n            :key=\"item.academicYear\"\r\n            :label=\"item.academicYear\"\r\n            :value=\"item.academicYear\"\r\n        >\r\n        </el-option>\r\n      </el-select>\r\n      <el-select v-model=\"semester\" style=\"margin-left: 5px\" placeholder=\"选择学期\">\r\n        <el-option\r\n            v-for=\"item in semOptions\"\r\n            :key=\"item.semester\"\r\n            :label=\"item.label\"\r\n            :value=\"item.semester\"\r\n        >\r\n        </el-option>\r\n      </el-select>\r\n      <el-select v-model=\"type\" style=\"margin-left: 5px\" placeholder=\"选择论文类型\">\r\n        <el-option\r\n            v-for=\"item in typeOptions\"\r\n            :key=\"item.type\"\r\n            :label=\"item.label\"\r\n            :value=\"item.type\"\r\n        >\r\n        </el-option>\r\n      </el-select>\r\n      <el-button type=\"primary\" style=\"margin-left: 5px\" @click=\"load\">查询</el-button>\r\n    </div>\r\n    <el-table\r\n        ref=\"multipleTable\"\r\n        :data=\"tableData\"\r\n        style=\"width: 100%\"\r\n        @selection-change=\"handleSelectionChange\"\r\n    >\r\n      <el-table-column type=\"selection\" width=\"55\" />\r\n      <el-table-column prop=\"id\" v-if=False label=\"序号\" sortable />\r\n      <el-table-column prop=\"batch\" v-if=False label=\"批次\" />\r\n      <el-table-column prop=\"thesisid\" label=\"论文编号\" sortable />\r\n      <el-table-column prop=\"title\" label=\"题目\" show-overflow-tooltip />\r\n      <!--      <el-table-column prop=\"submitTime\" value-format=\"YYYY-MM-DD\" label=\"提交时间\" />-->\r\n      <el-table-column prop=\"supervisor\" label=\"指导老师\" />\r\n      <el-table-column prop=\"department\" label=\"所在系\" />\r\n      <el-table-column prop=\"memo\" label=\"说明\" />\r\n      <el-table-column prop=\"grade\" label=\"得分\" />\r\n      <el-table-column prop=\"noes\" label=\"否决票数\" />\r\n      <el-table-column prop=\"yesses\" label=\"通过票数\" />\r\n    </el-table>\r\n\r\n    <div style=\"margin: 10px 0\">\r\n      <!--      <el-pagination-->\r\n      <!--          v-model:currentPage=\"currentPage\"-->\r\n      <!--          :page-sizes=\"[5, 10, 20]\"-->\r\n      <!--          :page-size=\"pageSize\"-->\r\n      <!--          layout=\"total, sizes, prev, pager, next, jumper\"-->\r\n      <!--          :total=\"total\"-->\r\n      <!--          @size-change=\"handleSizeChange\"-->\r\n      <!--          @current-change=\"handleCurrentChange\">-->\r\n      <!--      </el-pagination>-->\r\n\r\n      <el-dialog\r\n          v-model=\"dialogVisible1\" title=\"Tips\" width=\"80%\">\r\n        <el-form :model=\"form\" label-width=\"120px\">\r\n\r\n          <el-form-item label=\"会评主持人\">\r\n            <div style=\"margin: 10px 0\">\r\n              <el-input v-model=\"searchTeacher\" placeholder=\"请输入查询条件\" style=\"width: 80%\" clearable></el-input>\r\n              <el-button type=\"primary\" style=\"margin-left: 5px\" @click=\"loadTeacher\">查询</el-button>\r\n\r\n            </div>\r\n            <el-table :data=\"dtableData\"\r\n                      ref=\"multipleTable\"\r\n                      border\r\n                      style=\"width: 100%\"\r\n                      @selection-change=\"handleSelectionChange\"\r\n                      @select=\"select\"\r\n                      @select-all=\"selectAll\">\r\n              <el-table-column\r\n                  type=\"selection\"\r\n                  width=\"55\">\r\n              </el-table-column>\r\n              <!--              <el-table-column label=\"选择\">-->\r\n              <!--                <template slot-scope=\"scope\">-->\r\n              <!--                  <el-radio v-model=\"radio\" :label=\"scope.$index\"-->\r\n              <!--                            @change.native=\"radioChange(scope.row, scope.$index)\"-->\r\n              <!--                  >$nbsp;-->\r\n              <!--                  </el-radio>-->\r\n              <!--                </template>-->\r\n              <!--              </el-table-column>-->\r\n              <el-table-column prop=\"employeeId\" label=\"专家编号\"  />\r\n              <el-table-column prop=\"name\" label=\"专家姓名\"  />\r\n              <el-table-column prop=\"discipline\" label=\"学科\"  />\r\n              <el-table-column prop=\"direction\" label=\"研究方向\"  />\r\n              <el-table-column prop=\"department\" label=\"系\"  />\r\n              <el-table-column prop=\"field\" label=\"涉及领域\"  />\r\n            </el-table>\r\n            <div style=\"margin: 10px 0\">\r\n              <el-pagination\r\n                  v-model:currentPage=\"currentPageTeacher\"\r\n                  :page-sizes=\"[5, 10]\"\r\n                  :page-size=\"pageSizeTeacher\"\r\n                  layout=\"total, sizes, prev, pager, next, jumper\"\r\n                  :total=\"total\"\r\n                  @size-change=\"handleSizeChange\"\r\n                  @current-change=\"handleCurrentChange\">\r\n              </el-pagination>\r\n            </div>\r\n          </el-form-item>\r\n          <el-form-item label=\"应到人数\">\r\n            <el-input v-model=\"commiteeForm.supposedNumber\" style=\"width: 80%\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"实到人数\">\r\n            <el-input v-model=\"commiteeForm.attendanceNumber\" style=\"width: 80%\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"会评地点\">\r\n            <el-input type=\"textarea\" v-model=\"commiteeForm.address\" style=\"width: 80%\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"会评时间\">\r\n            <div class=\"block\">\r\n              <!--              <span class=\"demonstration\">默认</span>-->\r\n              <div class='startTime'>\r\n                开始时间：<el-date-picker v-model=\"commiteeForm.startTime\" type=\"datetime\"  @change=\"changeStartTime\" :clearable=\"false\"\r\n                                     placeholder=\"选择日期\" :picker-options=\"startDateLimit\">\r\n              </el-date-picker>\r\n                <span class=\"important\">*</span>\r\n              </div>\r\n              <!-- 结束时间 -->\r\n              <div class=\"endTime\">\r\n                结束时间：<el-date-picker v-model=\"commiteeForm.endTime\" :picker-options=\"endDateLimit\" type=\"datetime\" :clearable=\"false\" @change=\"changeEndTime\" placeholder=\"选择日期\">\r\n              </el-date-picker>\r\n                <span class=\"important\">*</span>\r\n              </div>\r\n            </div>\r\n          </el-form-item>\r\n        </el-form>\r\n        <template #footer>\r\n          <span class=\"dialog-footer\">\r\n            <el-button @click=\"dialogVisible1 = false\">取 消</el-button>\r\n            <el-button type=\"primary\" @click=\"save\">确 定</el-button>\r\n          </span>\r\n        </template>\r\n      </el-dialog>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport request from \"@/utils/request\";\r\nimport {ref} from \"vue\";\r\n\r\nexport default {\r\n  name: \"Committee\",\r\n  components:{},\r\n  data() {\r\n    return {\r\n      distinctYear:[],\r\n      academicYear:'',\r\n      semOptions:ref([\r\n        {\r\n          semester: '第一学期',\r\n          label: '第一学期',\r\n        },\r\n        {\r\n          semester: '第二学期',\r\n          label: '第二学期',\r\n        }]),\r\n      semester:ref(''),\r\n      typeOptions:ref([\r\n        {\r\n          type: '学硕',\r\n          label: '学硕',\r\n        },\r\n        {\r\n          type: '专硕',\r\n          label: '专硕',\r\n        }]),\r\n      type:ref(''),\r\n      batch:'',\r\n      startDateLimit: {\r\n        disabledDate: (time) => {\r\n          // if (this.value2 != \"\") {\r\n          //   return time.getTime() > new Date(this.value2).getTime();\r\n          // }else{\r\n          return time.getTime() < Date.now() - 8.64e7;//禁用当前日期之前的时间；如果没有后面的-8.64e6就是不可以选择今天的\r\n          // }\r\n        }\r\n      },\r\n      endDateLimit: {\r\n        disabledDate: (time) => {\r\n          if(this.commiteeForm.endTime!= \"\"){\r\n            return time.getTime() < new Date(this.value1).getTime()//禁用开始日期之前的日期\r\n          }\r\n          return time.getTime() < Date.now() - 8.64e7; //减去一天的时间代表可以选择同一天;\r\n        }\r\n      },\r\n      commiteeForm: {//write into committee table\r\n        id:null,\r\n        startTime: null, //开始时间\r\n        endTime: null, //结束时间\r\n        address: null,\r\n        afterDefence: 2,\r\n        attendanceNumber:null,\r\n        chairmanId:null,\r\n        supposedNumber:null,\r\n        thesisNumber:null\r\n      },\r\n      commiteevoteForm: {//write into commiteevote table\r\n        thesisid:'',\r\n        committeeid:'',\r\n      },\r\n      committeeid:'',\r\n      dtableData:[],\r\n      searchTeacher:'',\r\n      currentPageTeacher: 1,\r\n      pageSizeTeacher: 10,\r\n      multipleSelection: [],//teacher multiple choice\r\n      dialogVisible1:false,\r\n      tableData:[],\r\n      thesisid:\"\",\r\n      multipleSelectionthesis:[],\r\n      thesisform:{\r\n        id:'',\r\n        status:'',\r\n      }\r\n    }\r\n  },\r\n\r\n  created() {\r\n    this.load()\r\n  },\r\n  mounted() {\r\n    this.getYear();\r\n  },\r\n  methods:{\r\n    select(selection, row) {\r\n      if (selection.length > 1) {\r\n        let del_row = selection.shift()\r\n        this.$refs.multipleTable.toggleRowSelection(del_row, false)\r\n        // this.$message({\r\n        //   type: \"error\",\r\n        //   message: \"已选择超过一位评审专家！\"\r\n        // })\r\n      }\r\n    },\r\n    selectAll(selection){\r\n      if (selection.length > 1) {\r\n        selection.length = 1\r\n\r\n      }\r\n\r\n    },\r\n\r\n    save(){\r\n      for(var i = 0;i < this.multipleSelectionthesis.length;i++) {\r\n        this.thesisform.id=this.multipleSelectionthesis[i].id;\r\n        this.thesisform.status=\"11\";\r\n        request.put(\"/thesis\",this.thesisform)\r\n      }\r\n      this.dialogVisible1=false;\r\n      this.commiteeForm.chairmanId = this.multipleSelection[0].employeeId;\r\n      console.log(this.commiteeForm)\r\n      request.post(\"/committee\", this.commiteeForm).then(res => {\r\n        console.log(res)\r\n        this.committeeid=res.data;\r\n        // if (res.code === '0') {\r\n        //   console.log(this.commiteevoteForm)\r\n        //   this.$message({\r\n        //     type: \"success\",\r\n        //     message: \"安排成功\"\r\n        //   })\r\n        // } else {\r\n        //   this.$message({\r\n        //     type: \"error\",\r\n        //     message: res.msg\r\n        //   })\r\n        // }\r\n\r\n      });\r\n\r\n      // console.log(this.commiteevoteForm)\r\n      for(var i = 0;i < this.multipleSelectionthesis.length;i++) {\r\n        this.commiteevoteForm.thesisid = this.multipleSelectionthesis[i].thesisid\r\n        this.commiteevoteForm.committeeid = this.committeeid\r\n        console.log(this.commiteevoteForm)\r\n        request.post(\"/committeevote\", this.commiteevoteForm).then(res => {\r\n          console.log(res)\r\n          if (res.code === '0') {\r\n            this.$message({\r\n              type: \"success\",\r\n              message: \"分配成功\"\r\n            })\r\n          } else {\r\n            this.$message({\r\n              type: \"error\",\r\n              message: res.msg\r\n            })\r\n          }\r\n\r\n        });\r\n      }\r\n      this.load()\r\n    },\r\n\r\n    loadTeacher(){\r\n      request.get(\"/teacher\",{\r\n        params: {\r\n          pageNum: this.currentPageTeacher,\r\n          pageSize: this.pageSizeTeacher,\r\n          search: this.searchTeacher\r\n        }\r\n      }).then(res=>{\r\n        console.log(res)\r\n        this.dtableData=res.data.records\r\n        this.total=res.data.total\r\n      })\r\n    },\r\n    handleArrange(){\r\n\r\n      this.dialogVisible1=true;\r\n\r\n      this.loadTeacher();\r\n    },\r\n    //表格多选\r\n    handleSelectionChange(val) {\r\n\r\n      if(this.dialogVisible1==true){\r\n        this.multipleSelection = val\r\n        console.log(this.multipleSelection)\r\n      }else {\r\n        this.multipleSelectionthesis = val\r\n        console.log(this.multipleSelectionthesis)\r\n      }\r\n    },\r\n    //选定表格指定列\r\n    toggleSelection(rows) {\r\n      if (rows) {\r\n        rows.forEach((row) => {\r\n          this.$refs.multipleTable.toggleRowSelection(row)\r\n        })\r\n      } else {\r\n        this.$refs.multipleTable.clearSelection()\r\n      }\r\n    },\r\n    getYear(){\r\n      request.put(\"/batch/distinctYear\").then(res=>{\r\n        console.log(res)\r\n        this.distinctYear=res.data\r\n        this.total=res.data.total\r\n      })\r\n    },\r\n    getBatch(){\r\n      request.get(\"/batch/getbatchID\",{\r\n        params:{\r\n          year:this.academicYear,\r\n          semester:this.semester,\r\n          type:this.type\r\n        }\r\n      }).then(res=>{\r\n        console.log(res)\r\n        this.batch=res.data\r\n        this.total=res.data.total\r\n      })\r\n    },\r\n    load(){\r\n      this.getBatch()\r\n      request.get(\"/defense/defCommitteeVO\",{\r\n        params: {\r\n          batch:this.batch\r\n        }\r\n      }).then(res=>{\r\n        console.log(res)\r\n        this.tableData=res.data\r\n        this.total=res.data.total\r\n      })\r\n    },\r\n\r\n  }\r\n\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.el-pagination {\r\n  text-align: center;\r\n}\r\n</style>"]}]}